# 컴퓨터 구조  

## 2장 CPU의 구조와 기능  

### CPU의 기능
>- 명령어 인출(Instruction Fetch) : 기억 장치로부터 명령어를 읽어옴
>- 명령어 해독(Instruction Decode) : 수행해야 할 동작을 결정하기 위해 명령어 해독
>   &rarr; 위 두 기능은 모든 명령어에 공통으로 수행
>- 데이터 인출(Data Fetch) : 명령어 실행을 위해 데이터 필요시, 기억장치 or I/O 장치로부터 데이터 읽어옴
>- 데이터 처리(Data Process) : 데이터에 대한 산술적, 논리적 연산 수행
>- 데이터 저장(Data Store) : 수행한 결과 저장
>   &rarr; 명령어에 따라 필요한 경우만 수행  

### CPU의 기본 구조
> #### 산술 논리 연산 장치(ALU)
>   - 각종 산술 연산들과 논리 연산들을 수행하는 회로
>   - 산술 연산 : +,-,\*,/
>   - 논리 연산 : AND, OR, NOT, XOR
>
> #### 레지스터
>   - 엑세스 속도가 가장 **빠른 기억 장치**
>   - CPU에 포함 가능한 레지스터 수 제한(특수 목적용, 일반 목적용)
>
>#### 제어 유니트
>   - 프로그램 코드(명령어)를 해석, 실행 하기위한 제어 신호를 순차적으로 발생시키는 모듈  

### 명령어 실행
>#### 명령어 사이클
> : CPU가 한 개의 명령어를 실행하는데 필요한 전체 처리 과정
>
>   <img src="./Basic Instruction cycle.PNG"/>
>
>#### 두개의 부사이클(subcycle)들로 분리
>   - 인출 사이클(fetch cycle) : CPU가 기억 장치로부터 <u>명령어를 읽어오는 단계</u>
>   - 실행 사이클(execution cycle) : 명령어를 <u>실행하는 단계</u>
>
>#### 명령어 실행에 필요한 CPU 내부 레지스터들
>   - 프로그램 카운터(Program Counter: PC)
>       - 다음에 인출할 명령어의 주소를 가지고 있는 레지스터
>       - 각 명령어가 인출된 후에는 자동적으로 일정 크기(한 명령어 길이)만큼 증가
>   - 누산기(Accumulator: AC) &rarr; <span style="color:#0000FF">ALU가 사용</span>
>       - 데이터를 일시적으로 저장하는 레지스터
>       - 레지스터의 길이는 CPU가 한번에 처리할 수 있는 데이터 비트 수와 동일
>   - 명령어 레지스터(Instruction Register: IR)
>       - 가장 최근에 인출된 명령어 코드가 저장되어 있는 레지스터
>   - 기억장치 주소 레지스터(Memory Address Register: MAR)
>       - 프로그램 카운터에 저장된 명령어 주소가 시스템 주소 버스로 출력되기 전에 일시적으로 저장되는 <u>주소 레지스터</u>
>   - 기억장치 버퍼 레지스터(Memory Buffer Register: MBR)
>       - 쓰여질 or 읽혀진 데이터를 일시적으로 저장하는 버퍼 레지스터
> 
>#### 데이터 통로가 표시된 CPU 내부 구조
>   <img src="./CPU Internal Structure.png">  

### 인출 사이클
>- 기억장치의 지정된 위치로부터 명령어를 읽어오는 과정
>- 과정
>   - 각 명령어 사이클의 시작 단계에서 프로그램 카운터가 가리키는 기억장치의 위치에서 명령어 인출 &rarr; PC + 1 (여기서 1은 주소의 용량에 따라 바뀔 수 있음)
>- 인출 사이클의 마이크로 연산  
>   <img src="./Fetch cycle micro operation.png">
>   1. 현재의 PC 내용을 CPU 내부 버스를 통해 MAR로 전송
>   2. 그 주소가 지정하는 기억장치 위치로부터 읽어진 명령어가 데이터 버스를 통해 MBR로 적재 후 PC의 주소값에 +1
>   3. MBR에 있는 명령어 코드가 명령어 레지스터인 IR로 이동
>       예. CPU 클록 주파수 = 1GHz &rarr; 클럭 주기 1ns
>       &rarr; 인출 사이클 : 1ns * 3 = 3ns 소요  

### 실행 사이클
>- 실행 사이클 동안 명령어 코드를 해독(Decode), 그 결과에 따라 필요한 연산 수행
>- CPU가 수행하는 연산의 종류
>   - 데이터 이동 : CPU와 기억장치 간 혹은 I/O장치 간에 데이터를 이동
>   - 데이터 처리 : 데이터에 대해 산술, 논리 연산 수행
>   - 데이터 저장 : 연산 결과 데이터 혹은 입력장치로부터 읽어온 데이터를 기억장치에 저장
>   - 프로그램 제어 : 프로그램 실행 순서 결정
>- 실행 사이클에서 수행되는 마이크로 연산들은 명령어의 종류에 따라 다름
  
### 기본적인 명령어 형식의 구성
>- 연산 코드(Operation Code)
>   - CPU가 수행할 연산을 지정
>- 오퍼랜드(Operand)
>   - 명령어 실행에 필요한 데이터가 저장된 주소  
>   <img src="../1장/opcode, operand.PNG" width="80%" height="80%"/>  

### 어셈블리 프로그램 실행과정의 예
>